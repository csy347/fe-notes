title: tcp.md
date: 2018-06-11 12:00:00
categories: Node
tags: Tcp

---

## 1. TCP

在Node.js中，net模块实现了基于TCP的数据通信

### 1.1 创建TCP服务器

``` js
let net = require('net');
let server = net.createServer();

server.on('connection', (socket) => {
    socket.setEncoding('utf8');
    socket.on('data', (data) => {});
    socket.on('end', () => {});
});
srever.listen(8080, 'localhost', () => {});

```

### 1.2 服务器参数

* address
* connections
* close
* unref & ref

### 1.3 socket对象

* address
* 读取数据
* pipe & unpipe
* write
* bufferSize
* setTimeout
* pause && resume
* keepAlive

### 1.4 创建TCP客户端

```js
let socket = new net.Socket(options);
socket.on('connect', callback);
---或者---
socket.connect(port, host, callback);
```

* write 向服务器写入数据
* end 结束连接
* error 连接发生错误
* destroy 销毁流
* close 连接关闭成功， hasError = true 代表有可能有错误

### 1.5 聊天室1.0

-- 未完成

### 1.6 聊天室2.0

-- 未完成

## 2. UDP

### 2.1 UDP服务端

```js
let dgram = require('dgram');
let socket = dgram.createSocket('udp4');
socket.on('message', (msg, rinfo) => {
    console.log(msg.toString());
    socket.send('nihao', rinfo.port, rinfo.address);
});
socket.bind(41234, 'localhost');
```

### 2.2 UDP客户端

```js
let dgram = require('dgram');
let socket = dgram.createSocket('udp4');
socket.send('zf', 41234, 'localhost', (err, bytes) => {
    console.log('send');
});
socket.on('message', function(data){
    console.log(data, toString());
});
```

## 附录

* putty https://www.putty.org/
* win用户装 科来网络分析系统 http://www.colasoft.com.cn
* mac用户装 wireshark https://www.wireshark.org/download.html

**telnet**

**curl**

---

[来源](https://zhufengzhufeng.github.io/201802/html/17.tcp.html)